---
title: Netty 概述
date: 2025-02-13 14:42:37
tags:
- NIO
- Netty
categories: Netty
---

# Netty 官网说明

**Netty** 是一个异步事件驱动的网络应用程序框架，用于快速开发可维护的高性能协议服务器和客户端。

**Netty** 是一个 **NIO** 客户端服务器框架，可以快速轻松地开发网络应用程序（例如协议服务器和客户端）。它极大地简化和精简了 **TCP** 和 **UDP** 套接字服务器等网络编程。

“快速简便”并不意味着生成的应用程序会存在可维护性或性能问题。**Netty** 的设计非常谨慎，它借鉴了从实施大量协议（例如 FTP、SMTP、HTTP 以及各种二进制和基于文本的旧协议）中获得的经验。因此，**Netty** 成功地找到了一种无需妥协即可实现易于开发、性能、稳定性和灵活性的方法。

<img src="https://myblob-pics.oss-cn-hangzhou.aliyuncs.com/2025/netty/netty-components.png" style="zoom: 67%;" />

# The Problem 问题

今天，我们使用通用的应用程序或者类库来实现互相通讯，比如，我们经常使用一个 HTTP 客户端库来从 web 服务器上获取信息，或者通过 web 服务来执行一个远程的调用。

然而，有时候一个通用的协议或他的实现并没有很好的满足需求。比如我们无法使用一个通用的 HTTP 服务器来处理大文件、电子邮件以及近实时消息，比如金融信息和多人游戏数据。我们需要一个高度优化的协议来处理一些特殊的场景。例如你可能想实现一个优化了的 Ajax 的聊天应用、媒体流传输或者是大文件传输器，你甚至可以自己设计和实现一个全新的协议来准确地实现你的需求。

另一个不可避免的情况是当你不得不处理遗留的专有协议来确保与旧系统的互操作性。在这种情况下，重要的是我们如何才能快速实现协议而不牺牲应用的稳定性和性能。

## 原生 NIO 存在的问题

1. `NIO` 的类库和 `API` 繁杂，使用麻烦：需要熟练掌握 `Selector`、`ServerSocketChannel`、`SocketChannel`、`ByteBuffer`等。
2. 需要具备其他的额外技能：要熟悉 `Java` 多线程编程，因为 `NIO` 编程涉及到 `Reactor` 模式，你必须对多线程和网络编程非常熟悉，才能编写出高质量的 `NIO` 程序。
3. 开发工作量和难度都非常大：例如客户端面临断连重连、网络闪断、半包读写、失败缓存、网络拥塞和异常流的处理等等。4. `JDK NIO` 的 `Bug`：例如臭名昭著的 `Epoll Bug`，它会导致 `Selector` 空轮询，最终导致 `CPU100%`。直到 `JDK1.7` 版本该问题仍旧存在，没有被根本解决。

# The Solution 解决

[Netty](http://netty.io/) 是一个提供 `asynchronous event-driven` （异步事件驱动）的网络应用框架，是一个用以快速开发高性能、可扩展协议的服务器和客户端。

换句话说，**Netty** 是一个 **NIO** 客户端服务器框架，使用它可以快速简单地开发网络应用程序，比如服务器和客户端的协议。**Netty** 大大简化了网络程序的开发过程比如 **TCP** 和 **UDP** 的 **socket** 服务的开发。

“快速和简单”并不意味着应用程序会有难维护和性能低的问题，**Netty** 是一个精心设计的框架，它从许多协议的实现中吸收了很多的经验比如 **FTP**、**SMTP**、**HTTP**、许多二进制和基于文本的传统协议.因此，**Netty** 已经成功地找到一个方式,在不失灵活性的前提下来实现开发的简易性，高性能，稳定性。

有一些用户可能已经发现其他的一些网络框架也声称自己有同样的优势，所以你可能会问是 **Netty** 和它们的不同之处。答案就是 **Netty** 的哲学设计理念。**Netty** 从开始就为用户提供了用户体验最好的 API 以及实现设计。正是因为 **Netty** 的哲学设计理念，才让您得以轻松地阅读本指南并使用 **Netty**。

## Netty 的优点

`Netty` 对 `JDK` 自带的 `NIO` 的 `API` 进行了封装，解决了上述问题。

1. 设计优雅：适用于各种传输类型的统一 `API` 阻塞和非阻塞 `Socket`；基于灵活且可扩展的事件模型，可以清晰地分离关注点；高度可定制的线程模型-单线程，一个或多个线程池。
2. 使用方便：详细记录的 `Javadoc`，用户指南和示例；没有其他依赖项，`JDK5（Netty3.x）`或 `6（Netty4.x）`就足够了。
3. 高性能、吞吐量更高：延迟更低；减少资源消耗；最小化不必要的内存复制。
4. 安全：完整的 `SSL/TLS` 和 `StartTLS` 支持。
5. 社区活跃、不断更新：社区活跃，版本迭代周期短，发现的 `Bug` 可以被及时修复，同时，更多的新功能会被加入。

# Netty 常见使用场景

**Netty** 常见的使用场景如下：

1）互联网行业：在分布式系统中，各个节点之间需要远程服务调用，高性能的 **RPC** 框架必不可少，**Netty** 作为异步高性能的通信框架，往往作为基础通信组件被这些 RPC 框架使用。典型的应用有：阿里分布式服务框架 **Dubbo** 的 **RPC** 框架，**Dubbo** 协议默认使用 **Netty** 作为基础通信组件，用于实现各进程节点之间的内部通信。

2）游戏行业：无论是手游服务端还是大型的网络游戏，**Java** 语言得到了越来越广泛的应用。**Netty** 作为高性能的基础通信组件，它本身提供了 **TCP/UDP** 和 **HTTP** 协议栈。

非常方便定制和开发私有协议栈，账号登录服务器，地图服务器之间可以方便的通过 **Netty** 进行高性能的通信。

3）大数据领域：经典的 **Hadoop** 的高性能通信和序列化组件 **Avro** 的 **RPC** 框架，默认采用 **Netty** 进行跨界点通信，它的 **Netty Service** 基于 **Netty** 框架二次封装实现。

<img src="https://myblob-pics.oss-cn-hangzhou.aliyuncs.com/2025/netty/Middleware-netty.jpg" style="zoom:67%;" />

业界常⻅的涉及到网络通信的相关中间件大部分基于**Netty**实现网络层。
